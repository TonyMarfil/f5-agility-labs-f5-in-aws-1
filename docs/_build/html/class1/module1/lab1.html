
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2.1.1. Connecting to the Lab &#8212; f5-agility-labs-f5-in-aws-1  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2. Exploring AWS" href="../module2/module2.html" />
    <link rel="prev" title="2.1. Infrastructure As Code" href="module1.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="connecting-to-the-lab">
<h1>2.1.1. Connecting to the Lab<a class="headerlink" href="#connecting-to-the-lab" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Your student account, and short URL path will be announced at the start of the lab.</p>
</div>
<ul class="simple">
<li>Though the environment runs on a shared AWS account, every student will build and work in a dedicated AWS VPC.</li>
<li>For this lab, a Ravello Windows 10 remote desktop jump host will be provided as a consistent starting point.</li>
</ul>
<p>See <span class="xref std std-ref">Connecting to the Lab Environment</span> for directions on connecting to the lab environment.</p>
<p>You may find it easier to follow this lab by opening this document in web browser to ease the process of copy and pasting text.</p>
</div>
<div class="section" id="lab-variables">
<h1>2.1.2. Lab Variables<a class="headerlink" href="#lab-variables" title="Permalink to this headline">¶</a></h1>
<p>The lab will make use of unique variables to provide access to the lab and isolate student environments.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable Name</th>
<th class="head">Variable Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>shortUrl</td>
<td>Unique Key that provides access to this lab (i.e. abc123)</td>
</tr>
<tr class="row-odd"><td>emailid</td>
<td>Account name for each student (i.e. <a class="reference external" href="mailto:user01&#37;&#52;&#48;f5demo&#46;com">user01<span>&#64;</span>f5demo<span>&#46;</span>com</a>)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="run-docker">
<h1>2.1.3. Run Docker<a class="headerlink" href="#run-docker" title="Permalink to this headline">¶</a></h1>
<p>From your open Putty Window in your Windows jumphost, launch the f5-super-netops docker container.</p>
<p>Cut and past the command below to accomplish the steps above.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run -p <span class="m">8080</span>:80 -p <span class="m">2222</span>:22 -it -e <span class="nv">SNOPS_AUTOCLONE</span><span class="o">=</span><span class="m">0</span> --name dev --restart always tonymarfil/f5-aws-lab:base
</pre></div>
</div>
<p>This command will launch  in interactive mode, map port 22 on the container with 2222 on the host, and port 80 on the container with 8080 on the host.</p>
<p>You should see the resulting screen.</p>
<a class="reference internal image-reference" href="_static/snops-launched.png"><img alt="_static/snops-launched.png" src="_static/snops-launched.png" /></a>
</div>
<div class="section" id="set-variables">
<h1>2.1.4. Set Variables<a class="headerlink" href="#set-variables" title="Permalink to this headline">¶</a></h1>
<p>The following will store the lab variables that will be used later in the lab.</p>
<p>Export your student account and short URL path variables.
Your student account will be used to create an AWS console login and provide unique names for infrastructure that you create in the shared account. The short URL path will be used to grant access to the shared AWS account both via the AWS API and as the password for the AWS web console. Replace the emailid and shortUrl values below with the student account name and short URL assigned to you at the start of the lab.</p>
<p>Copy and paste the commands below to accomplish the steps above (replacing the example values with the values provided by your instructor).</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">emailid</span><span class="o">=</span>user01@f5demo.com
<span class="nb">export</span> <span class="nv">shortUrl</span><span class="o">=</span>abc123
printenv
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">printenv</span></code> command will echo all your environment variables.  Look for emailid and shortUrl. Confirm the exported variables are correct.</p>
</div>
<div class="section" id="initialize-your-lab-environment">
<h1>2.1.5. Initialize your Lab Environment<a class="headerlink" href="#initialize-your-lab-environment" title="Permalink to this headline">¶</a></h1>
<p>This will create an AWS credential that you will use to access the shared AWS account.</p>
<p>You will (instructions provided below)</p>
<ul class="simple">
<li>Change to your home directory.</li>
<li>Clone the git repository for this lab.</li>
<li>Change to the working directory.</li>
<li>Run the start script.</li>
</ul>
<p>Copy and paste the commands below to accomplish the steps above.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~
git clone https://github.com/TonyMarfil/marfil-f5-terraform
<span class="nb">cd</span> ~/marfil-f5-terraform/
<span class="nb">source</span> start
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">For a smooth ride, always invoke commands from inside the cloned git repository (marfil-f5-terraform). To check you’re in the right place you can run the command <code class="docutils literal notranslate"><span class="pre">pwd</span></code> and the output should read <code class="docutils literal notranslate"><span class="pre">/root/marfil-f5-terraform</span></code></p>
</div>
</div>
<div class="section" id="launch-terraform">
<h1>2.1.6. Launch Terraform<a class="headerlink" href="#launch-terraform" title="Permalink to this headline">¶</a></h1>
<p>Now that we have created credentials to access the AWS account we will use Terraform to deploy our lab environment.</p>
<p>Invoke terraform.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>terraform plan
</pre></div>
</div>
<p>This will output the changes that terraform will apply.  Now run.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>terraform apply
</pre></div>
</div>
<p>Once “terraform apply” completes, you can test your web server instances and ELB are up:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -I <span class="sb">`</span>terraform output elb_dns_name<span class="sb">`</span>
</pre></div>
</div>
<p>You should see a reply with status code “HTTP/1.1 200 OK”. Hit &lt;ctrl&gt;+C to stop.</p>
<p>When ‘terraform apply’ completes, note the **aws_alias** and vpc-id values. Open up your **aws_alias** link in a browser and login to the AWS console with the email address and password you created during the install. You can always get these values by invoking terraform output with the variable name:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>terraform output **aws_alias**
terraform output vpc-id
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">terraform apply will take five minutes to complete, but the environment will not be ready for another 15 minutes as the Big-IP virtual editions and supporting infrastructure wake up. In the meantime, we can begin to explore the AWS lab environment.</p>
</div>
</div>
<div class="section" id="what-just-happened-that-was-a-lot-of-random-text-scrolling-in-my-docker-console">
<h1>2.1.7. What just happened? That was a lot of random text scrolling in my Docker console!<a class="headerlink" href="#what-just-happened-that-was-a-lot-of-random-text-scrolling-in-my-docker-console" title="Permalink to this headline">¶</a></h1>
<p>This is the TL;DR version of the steps completed.</p>
<p>When you clone the git repository, you are pulling down a fresh copy of the all of the files you need to get started. These files are hosted on Github, the most popular online revision control repository, and include:</p>
<ul>
<li><p class="first">Onboarding scripts that create your AWS account and other prerequisites: <em>f5-super-netops-install.sh</em>, <em>addUser.sh</em>, <em>export.sh</em>.</p>
</li>
<li><p class="first">all of the terraform configuration files–a declarative, comprehensive representation of our entire application stack:</p>
<blockquote>
<div><p><em>main.tf</em> - Every terraform configuration has a main.tf. This contains all of the AWS specific (non-F5) environment configuration, including web instances</p>
<p><em>f5-cloudformation-autoscale-waf.tf</em> and <em>f5-cloudformation-cross-az-ha-hourly.tf</em> - Nothing more than a terraform file that takes the officially supported CloudFormation template hosted at:</p>
<p><a class="reference external" href="https://s3.amazonaws.com/f5-cft/f5-autoscale-bigip.template">https://s3.amazonaws.com/f5-cft/f5-autoscale-bigip.template</a></p>
<p><a class="reference external" href="https://s3.amazonaws.com/f5-cft/f5-existing-stack-across-az-cluster-hourly-2nic-bigip.template">https://s3.amazonaws.com/f5-cft/f5-existing-stack-across-az-cluster-hourly-2nic-bigip.template</a></p>
<p>…and stuffs all of the prerequisite parameters so we don’t have to do it manually.</p>
<p><em>outputs.tf</em> - Any variable in the outputs.tf file can be rendered to the console with ‘terraform output’ and is exposed to other command line tools.</p>
<p><em>vars.tf</em> - Variables for terraform.</p>
</div></blockquote>
</li>
<li><p class="first">Handy utilities to help move the lab along with minimum fuss: <em>lab-info</em>, <em>password-reset</em>, <em>lab-cleanup</em>.</p>
</li>
</ul>
<p>The start script takes care of all of the prerequisites to standing up an AWS environment. Precisely:</p>
<ul class="simple">
<li>Installs all of the necessary software, including: terraform, the aws cli, and various other command line tools.</li>
<li>Creates your AWS console login and api account and stores the keys locally for use by the AWS command line.</li>
<li>Creates SSH keys for use by all of your EC2 instances: web servers and Big-IP virtual editions.</li>
<li>Creates a self-signed SSL certificate for use in deploying https services.</li>
<li>Sets the default region: us-east-1 (Virginia), ap-southeast-1 (Singapore), etc.</li>
</ul>
<p>The terraform files go into effect when you invoke ‘terraform apply’. This step makes use of all of the prerequisites from the step before to build the environment in AWS.</p>
</div>
<div class="section" id="video-example">
<h1>2.1.8. Video example<a class="headerlink" href="#video-example" title="Permalink to this headline">¶</a></h1>
<p>This <a class="reference external" href="https://asciinema.org/a/Tj8vreWGmvXBT7dGhqv36RFMg">video</a> walks through all of the steps in this part of the lab. The emailid and shortUrl values used are only examples and no longer valid. You can pause, cut, and paste from the example, but always remember to replace the example values with the values assigned to you by the lab instructor.</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.1.1. Connecting to the Lab</a></li>
<li><a class="reference internal" href="#lab-variables">2.1.2. Lab Variables</a></li>
<li><a class="reference internal" href="#run-docker">2.1.3. Run Docker</a></li>
<li><a class="reference internal" href="#set-variables">2.1.4. Set Variables</a></li>
<li><a class="reference internal" href="#initialize-your-lab-environment">2.1.5. Initialize your Lab Environment</a></li>
<li><a class="reference internal" href="#launch-terraform">2.1.6. Launch Terraform</a></li>
<li><a class="reference internal" href="#what-just-happened-that-was-a-lot-of-random-text-scrolling-in-my-docker-console">2.1.7. What just happened? That was a lot of random text scrolling in my Docker console!</a></li>
<li><a class="reference internal" href="#video-example">2.1.8. Video example</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../class1.html">2. Class - |classname|</a><ul>
  <li><a href="module1.html">2.1. Infrastructure As Code</a><ul>
      <li>Previous: <a href="module1.html" title="previous chapter">2.1. Infrastructure As Code</a></li>
      <li>Next: <a href="../module2/module2.html" title="next chapter">2.2. Exploring AWS</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/class1/module1/lab1.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Tony Marfil.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../_sources/class1/module1/lab1.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>